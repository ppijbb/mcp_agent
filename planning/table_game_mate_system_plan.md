# 테이블게임 메이트 에이전트 시스템 개발 기획서

## 1. 프로젝트 개요

### 1.1 프로젝트 목표
범용적이고 확장 가능한 테이블게임 메이트 에이전트 시스템을 구축하여 사용자가 다양한 보드게임을 AI 플레이어들과 함께 즐길 수 있는 환경을 제공합니다.

### 1.2 핵심 특징
- **범용성**: 특정 게임이 아닌 모든 테이블탑 보드게임 지원
- **동적 게임 분석**: 실시간 게임 규칙 검색 및 분석
- **유동적 플레이어 생성**: 게임에 맞춘 AI 플레이어 동적 생성
- **페르소나 시스템**: 게임별 특화된 AI 성격 부여
- **사용자 참여**: 채팅을 통한 실시간 게임 참여

## 2. 기술 스택 분석 및 선택

### 2.1 아키텍처 선택: LangGraph vs MCP
조사 결과를 바탕으로 **LangGraph + MCP 하이브리드 아키텍처**를 채택합니다.

#### LangGraph 선택 이유:
- **상태 관리**: 복잡한 게임 상태를 안정적으로 관리
- **에이전트 오케스트레이션**: 다중 에이전트 시스템에 최적화
- **실시간 상호작용**: 스트리밍 지원으로 실시간 게임 진행 가능
- **디버깅 및 관찰**: 게임 진행 과정 추적 및 디버깅 용이
- **서브그래프**: 모듈화된 에이전트 시스템 구축 가능

#### MCP 통합 이유:
- **외부 데이터 접근**: BoardGameGeek API, 웹 검색 등
- **파일시스템 접근**: 게임 규칙 문서 관리
- **데이터베이스 연동**: 게임 기록 및 사용자 데이터 저장

### 2.2 핵심 MCP 서버 활용

#### 데이터 수집용 MCP 서버:
1. **Brave Search MCP**: 게임 규칙 검색
2. **Fetch MCP**: 웹 콘텐츠 수집 및 변환
3. **Filesystem MCP**: 로컬 게임 데이터 관리
4. **BGG API 커스텀 MCP**: BoardGameGeek 데이터 접근

#### 운영 지원용 MCP 서버:
1. **Memory MCP**: 게임별 지식 그래프 관리
2. **SQLite MCP**: 게임 기록 및 통계 저장
3. **Time MCP**: 게임 시간 관리

### 2.3 보드게임 데이터 소스

#### BoardGameGeek XML API 2 활용:
- **게임 정보**: `/xmlapi2/thing` - 게임 상세 정보, 규칙, 메타데이터
- **검색 기능**: `/xmlapi2/search` - 게임명 기반 검색
- **사용자 데이터**: `/xmlapi2/collection` - 사용자 게임 컬렉션
- **핫 아이템**: `/xmlapi2/hot` - 인기 게임 추천

#### 게임 엔진 라이브러리:
- **boardgame.io**: 턴 기반 게임 상태 관리
- **board-state**: 숨겨진 정보가 있는 게임 지원
- **game-state-machine**: 게임 규칙 상태 머신

## 3. 시스템 아키텍처

### 3.1 전체 시스템 구조

```
테이블게임 메이트 시스템
├── 사용자 인터페이스 (Streamlit/FastAPI)
├── 게임 마스터 에이전트 (LangGraph)
│   ├── 게임 검색 & 분석 에이전트
│   ├── 규칙 파서 & 검증 에이전트
│   ├── 플레이어 생성 매니저
│   ├── 페르소나 부여 에이전트
│   └── 게임 상태 관리자
├── 동적 플레이어 풀 (런타임 생성)
│   ├── 플레이어 에이전트 1-N
│   └── 각 에이전트별 고유 페르소나
├── 게임 관리 시스템
│   ├── 심판 & 규칙 검증 에이전트
│   └── 점수 & 승부 계산 에이전트
└── 외부 리소스 (MCP 서버들)
    ├── BoardGameGeek API
    ├── 웹 검색 엔진
    ├── 게임 규칙 DB
    └── 로컬 파일시스템
```

### 3.2 에이전트별 역할 정의

#### 게임 마스터 에이전트 (중앙 오케스트레이터)
- **책임**: 전체 게임 세션 관리 및 에이전트 간 조정
- **기능**: 
  - 사용자 요청 처리
  - 게임 선택 및 초기화
  - 플레이어 에이전트 생성 지시
  - 게임 진행 순서 관리

#### 게임 검색 & 분석 에이전트
- **책임**: 게임 정보 수집 및 분석
- **기능**:
  - BGG API를 통한 게임 검색
  - 웹 검색을 통한 규칙 수집
  - 게임 메타데이터 추출 (플레이어 수, 소요시간, 복잡도)
  - 게임 특성 분석 (전략성, 운, 상호작용 레벨)

#### 규칙 파서 & 검증 에이전트
- **책임**: 게임 규칙 구조화 및 검증
- **기능**:
  - 자연어 규칙을 구조화된 데이터로 변환
  - 게임 액션 유효성 검증
  - 승리 조건 확인
  - 턴 순서 및 페이즈 관리

#### 플레이어 생성 매니저
- **책임**: 게임별 최적 플레이어 수 결정 및 생성
- **기능**:
  - 게임 권장 플레이어 수 분석
  - 사용자 설정에 따른 플레이어 수 조정
  - 플레이어 에이전트 동적 생성
  - 플레이어별 역할 할당

#### 페르소나 부여 에이전트
- **책임**: 게임별 특화된 AI 성격 생성
- **기능**:
  - 게임 특성 분석 (협력/경쟁, 전략/운, 단순/복잡)
  - 적합한 페르소나 타입 결정
  - 각 플레이어별 고유 성격 생성
  - 페르소나 간 밸런스 조정

#### 심판 & 규칙 검증 에이전트
- **책임**: 게임 액션 검증 및 분쟁 해결
- **기능**:
  - 플레이어 액션 유효성 검사
  - 규칙 위반 감지 및 경고
  - 모호한 상황 해석
  - 게임 상태 무결성 유지

#### 점수 & 승부 계산 에이전트
- **책임**: 게임 결과 계산 및 통계 관리
- **기능**:
  - 실시간 점수 계산
  - 승리 조건 확인
  - 게임 통계 수집
  - 플레이어 성과 분석

### 3.3 페르소나 시스템 설계

#### 게임 특성별 페르소나 매트릭스

| 게임 타입 | 페르소나 예시 | 특징 |
|----------|--------------|------|
| **전략 게임** (ex: 카탄) | 장기적 사고자, 리스크 테이커, 자원 최적화자 | 계획적, 분석적, 예측 중심 |
| **사회적 추론** (ex: 마피아) | 의심 많은 탐정, 거짓말 전문가, 순진한 시민 | 심리전, 관찰력, 설득 |
| **협상 게임** (ex: 디플로마시) | 강경 협상가, 윈윈 추구자, 기회주의자 | 외교적, 전술적, 적응적 |
| **덱빌딩** (ex: 도미니언) | 콤보 추구자, 엔진 빌더, 방해 전문가 | 시너지, 효율성, 타이밍 |

#### 페르소나 생성 알고리즘
1. **게임 특성 분석**: 복잡도, 상호작용 레벨, 운vs전략 비율
2. **페르소나 풀 생성**: 게임에 적합한 5-10개 후보 생성
3. **균형 조정**: 너무 유사하거나 극단적인 조합 방지
4. **개성 부여**: 각 에이전트별 고유한 말투와 전략 스타일

## 4. 구현 계획

### 4.1 Phase 1: 핵심 인프라 구축 (2-3주)

#### 개발 목표:
- LangGraph 기반 기본 에이전트 시스템 구축
- MCP 서버 통합 및 연동
- 간단한 게임으로 POC 검증

#### 주요 작업:
1. **프로젝트 셋업**
   - LangGraph + MCP 환경 구성
   - 기본 프로젝트 구조 설계
   - 테스트 환경 구축

2. **MCP 서버 통합**
   - BGG API MCP 서버 개발
   - Brave Search, Fetch, Filesystem MCP 연동
   - Memory, SQLite MCP 설정

3. **기본 에이전트 개발**
   - 게임 마스터 에이전트 기본 구조
   - 게임 검색 에이전트
   - 단순한 플레이어 에이전트

4. **POC 검증**
   - 간단한 게임 (틱택토, 가위바위보, UNO, 스플렌더, 체커, 오델로) 검증
   - 기본 게임 플로우 검증

### 4.2 Phase 2: 게임 규칙 시스템 (3-4주)

#### 개발 목표:
- 복잡한 보드게임 규칙 처리 시스템
- 규칙 파싱 및 검증 에이전트
- 게임 상태 관리 시스템

#### 주요 작업:
1. **규칙 파서 개발**
   - 자연어 규칙을 구조화된 데이터로 변환
   - 게임 액션 정의 및 검증 시스템
   - 턴 시퀀스 및 페이즈 관리

2. **게임 상태 관리**
   - 복잡한 게임 상태 추적
   - 히스토리 관리 및 되돌리기
   - 병렬 액션 처리

3. **중급 게임 검증**
   - 카드 게임 (포커, 섯다, 뱅, 카탄, 도미니언)
   - 보드 게임 (TRPG, 워해머, 마작, 브루마블, 마피아 게임, 디플로마시)
   - 규칙 복잡도 단계적 증가

### 4.3 Phase 3: 페르소나 시스템 (2-3주)

#### 개발 목표:
- 동적 페르소나 생성 시스템
- 게임별 특화 AI 플레이어
- 균형잡힌 게임 경험 제공

#### 주요 작업:
1. **페르소나 생성 엔진**
   - 게임 특성 분석 알고리즘
   - 페르소나 템플릿 시스템
   - 동적 성격 생성

2. **플레이어 에이전트 고도화**
   - 페르소나 기반 의사결정
   - 게임별 전략 패턴
   - 적응적 학습 시스템

3. **밸런싱 시스템**
   - 플레이어 간 실력 조정
   - 게임 재미 최적화
   - 사용자 선호도 반영

### 4.4 Phase 4: 고급 게임 지원 (4-5주)

#### 개발 목표:
- 복잡한 보드게임 지원
- 협상, 블러핑, 숨겨진 정보 처리
- 멀티플레이어 상호작용

#### 주요 작업:
1. **고급 게임 메커니즘**
   - 숨겨진 정보 관리
   - 블러핑 및 추론 시스템
   - 협상 및 외교 메커니즘

2. **복잡한 게임 구현**
   - 마피아/웨어울프
   - 뱅! (Bang!)
   - 카탄의 개척자들
   - 7 원더스

3. **사용자 경험 최적화**
   - 실시간 채팅 인터페이스
   - 게임 진행 시각화
   - 도움말 및 규칙 안내

### 4.5 Phase 5: 시스템 완성 및 최적화 (2-3주)

#### 개발 목표:
- 시스템 안정성 및 성능 최적화
- 사용자 인터페이스 완성
- 배포 준비

#### 주요 작업:
1. **성능 최적화**
   - 메모리 사용량 최적화
   - 응답 속도 개선
   - 동시 게임 세션 지원

2. **UI/UX 개선**
   - Streamlit 대시보드 고도화
   - 모바일 반응형 디자인
   - 접근성 개선

3. **배포 및 운영**
   - Docker 컨테이너화
   - CI/CD 파이프라인
   - 모니터링 시스템

## 5. 기술적 고려사항

### 5.1 확장성
- **모듈형 아키텍처**: 새로운 게임 쉽게 추가 가능
- **플러그인 시스템**: 커스텀 게임 규칙 지원
- **클라우드 확장**: 다중 사용자 및 동시 세션 지원

### 5.2 성능
- **비동기 처리**: 실시간 게임 진행
- **캐싱 시스템**: 게임 규칙 및 데이터 캐싱
- **리소스 관리**: 메모리 및 CPU 효율적 사용

### 5.3 보안
- **데이터 프라이버시**: 사용자 게임 기록 보호
- **API 보안**: 외부 서비스 연동 보안
- **입력 검증**: 악의적 입력 방지

### 5.4 사용자 경험
- **직관적 인터페이스**: 복잡한 시스템을 간단하게
- **실시간 피드백**: 게임 상황 실시간 안내
- **맞춤화**: 사용자 선호도 반영

## 6. 예상 결과물

### 6.1 핵심 기능
1. **게임 추천**: 사용자 선호도 기반 게임 추천
2. **자동 게임 설정**: 게임 규칙 자동 분석 및 설정
3. **AI 플레이어**: 게임별 특화된 AI 플레이어 생성
4. **실시간 게임**: 채팅을 통한 실시간 게임 진행
5. **게임 기록**: 플레이 히스토리 및 통계

### 6.2 지원 게임 범위
- **초급**: 틱택토, 가위바위보, UNO
- **중급**: 체커, 오델로, 스플렌더
- **고급**: 마피아, 뱅!, 카탄, 7원더스
- **확장**: BoardGameGeek 상위 100개 게임

### 6.3 기술적 성과
- **범용 게임 엔진**: 모든 테이블탑 게임 지원 가능
- **동적 AI 생성**: 게임별 맞춤 AI 플레이어
- **실시간 처리**: 끊김없는 게임 경험
- **확장 가능**: 새로운 게임 쉽게 추가

## 7. 리스크 관리

### 7.1 기술적 리스크
- **복잡성 증가**: 단계적 개발로 복잡성 관리
- **성능 이슈**: 조기 프로파일링 및 최적화
- **API 제한**: 다중 데이터 소스 활용

### 7.2 개발 리스크
- **일정 지연**: 버퍼 시간 포함한 계획
- **품질 관리**: 지속적 테스트 및 검증
- **범위 확장**: 핵심 기능 우선 개발

### 7.3 운영 리스크
- **사용자 피드백**: 조기 프로토타입 공유
- **확장성**: 클라우드 기반 아키텍처
- **유지보수**: 문서화 및 모니터링

## 8. 성공 지표

### 8.1 기능적 지표
- 지원 게임 수: 최소 20개 이상
- 게임 설정 자동화율: 90% 이상
- AI 플레이어 만족도: 4.0/5.0 이상

### 8.2 기술적 지표
- 시스템 응답시간: 평균 2초 이내
- 시스템 가용성: 99% 이상
- 동시 세션 지원: 10개 이상

### 8.3 사용자 지표
- 사용자 만족도: 4.5/5.0 이상
- 재사용률: 70% 이상
- 게임 완주율: 85% 이상

## 9. 결론

본 테이블게임 메이트 에이전트 시스템은 LangGraph의 강력한 멀티에이전트 오케스트레이션 기능과 MCP의 다양한 데이터 소스 연동 능력을 결합하여, 사용자가 어떤 보드게임이든 AI 플레이어들과 함께 즐길 수 있는 혁신적인 플랫폼을 구축하는 것을 목표로 합니다.

핵심 차별점인 동적 게임 분석, 실시간 AI 플레이어 생성, 게임별 특화 페르소나 시스템을 통해 기존의 고정된 게임 시스템과는 차원이 다른 유연하고 확장 가능한 게임 경험을 제공할 수 있을 것입니다.

5단계로 나누어진 체계적인 개발 계획을 통해 안정적이고 확장 가능한 시스템을 구축하며, 단계별 검증을 통해 품질을 보장하고 리스크를 최소화할 수 있을 것입니다. 